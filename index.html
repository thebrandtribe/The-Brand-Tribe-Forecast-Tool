<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Brand Tribe - Forecasting Sales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f9fafb; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
        .ninja-card { background: white; border: 1px solid #e5e7eb; border-radius: 12px; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .quote-style { font-style: italic; color: #6b7280; }
    </style>
</head>
<body class="pb-32">

    <div class="bg-white p-6 border-b sticky top-0 z-30 shadow-sm flex flex-col items-center gap-2">
        <img src="YOUR_LOGO_URL_HERE" alt="The Brand Tribe" class="h-12 mb-2" onerror="this.src='https://via.placeholder.com/200x50?text=THE+BRAND+TRIBE'">
        <h1 class="font-bold text-xs tracking-[0.3em] uppercase text-gray-500">Forecasting Sales</h1>
    </div>

    <div class="p-4 max-w-2xl mx-auto">
        
        <div class="text-center my-8 px-6">
            <p class="quote-style text-lg">"A vision remains a dream until it is measured; you cannot achieve your goals without knowing exactly what they are."</p>
        </div>

        <div class="grid grid-cols-3 gap-3 mb-8">
            <div class="bg-gray-900 text-white p-4 rounded-2xl shadow-lg">
                <p class="text-[10px] font-bold uppercase opacity-60 mb-1">Yearly Target</p>
                <div class="flex items-center">
                    <span class="cur-sym mr-1 text-sm">£</span>
                    <input type="number" id="annual-target" oninput="calculate()" class="bg-transparent font-black text-xl w-full focus:outline-none" value="100000">
                </div>
            </div>
            <div class="bg-white p-4 rounded-2xl border border-gray-200 shadow-sm">
                <p class="text-[10px] text-gray-400 font-bold uppercase mb-1">Forecast</p>
                <p class="text-xl font-black text-gray-800" id="total-f">£0</p>
            </div>
            <div class="bg-white p-4 rounded-2xl border border-gray-200 shadow-sm">
                <p class="text-[10px] text-gray-400 font-bold uppercase mb-1">Actual</p>
                <p class="text-xl font-black text-green-600" id="total-a">£0</p>
            </div>
        </div>

        <div id="quarterly-grid" class="grid grid-cols-2 gap-4 mb-10">
            </div>

        <div id="month-list" class="space-y-6">
            </div>
    </div>

    <div class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-between items-center p-4 px-8 shadow-2xl z-40">
        <select id="currency" onchange="calculate()" class="bg-gray-100 border-none rounded-lg px-3 py-2 text-xs font-bold uppercase">
            <option value="£">GBP £</option>
            <option value="$">USD $</option>
            <option value="€">EUR €</option>
        </select>
        <button onclick="window.print()" class="text-gray-400 hover:text-black flex flex-col items-center">
            <i class="fas fa-print"></i>
            <span class="text-[9px] font-bold mt-1">PRINT</span>
        </button>
        <button onclick="if(confirm('Clear all data?')) { localStorage.clear(); location.reload(); }" class="text-gray-400 hover:text-red-500 flex flex-col items-center">
            <i class="fas fa-trash-alt"></i>
            <span class="text-[9px] font-bold mt-1">RESET</span>
        </button>
    </div>

    <script>
        const monthConfig = [
            { name: "April", q: 1 }, { name: "May", q: 1 }, { name: "June", q: 1 },
            { name: "July", q: 2 }, { name: "August", q: 2 }, { name: "September", q: 2 },
            { name: "October", q: 3 }, { name: "November", q: 3 }, { name: "December", q: 3 },
            { name: "January", q: 4 }, { name: "February", q: 4 }, { name: "March", q: 4 }
        ];

        // Persistence Logic
        let state = JSON.parse(localStorage.getItem('tribe_v2_data')) || {
            target: 100000,
            months: monthConfig.map(() => [{ client: '', forecast: 0, actual: 0 }])
        };

        function init() {
            document.getElementById('annual-target').value = state.target;
            renderAll();
        }

        function renderAll() {
            const list = document.getElementById('month-list');
            list.innerHTML = '';
            
            state.months.forEach((clients, mIdx) => {
                let monthHtml = `
                    <div class="ninja-card overflow-hidden shadow-sm">
                        <div class="bg-gray-50 p-3 border-b flex justify-between items-center">
                            <span class="font-black text-gray-800 uppercase text-xs tracking-widest">${monthConfig[mIdx].name}</span>
                            <button onclick="addClient(${mIdx})" class="text-[10px] bg-gray-800 text-white px-3 py-1 rounded-full font-bold hover:bg-black">
                                + ADD CUSTOMER
                            </button>
                        </div>
                        <div class="p-4 space-y-3">
                            ${clients.map((c, cIdx) => `
                                <div class="grid grid-cols-12 gap-2 items-end pb-2 border-b border-gray-50">
                                    <div class="col-span-6">
                                        <input type="text" value="${c.client}" oninput="updateData(${mIdx}, ${cIdx}, 'client', this.value)" 
                                            class="w-full text-xs font-bold focus:outline-none placeholder-gray-300" placeholder="Customer Name">
                                    </div>
                                    <div class="col-span-2">
                                        <input type="number" value="${c.forecast}" oninput="updateData(${mIdx}, ${cIdx}, 'forecast', this.value)" 
                                            class="w-full text-xs font-medium focus:outline-none" placeholder="F">
                                    </div>
                                    <div class="col-span-2">
                                        <input type="number" value="${c.actual}" oninput="updateData(${mIdx}, ${cIdx}, 'actual', this.value)" 
                                            class="w-full text-xs font-bold text-green-600 focus:outline-none" placeholder="A">
                                    </div>
                                    <div class="col-span-2 text-right">
                                        <button onclick="removeClient(${mIdx}, ${cIdx})" class="text-gray-300 hover:text-red-500"><i class="fas fa-times"></i></button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>`;
                list.innerHTML += monthHtml;
            });
            calculate();
        }

        function addClient(mIdx) {
            state.months[mIdx].push({ client: '', forecast: 0, actual: 0 });
            saveAndRefresh();
        }

        function removeClient(mIdx, cIdx) {
            if(state.months[mIdx].length > 1) {
                state.months[mIdx].splice(cIdx, 1);
                saveAndRefresh();
            }
        }

        function updateData(mIdx, cIdx, field, val) {
            state.months[mIdx][cIdx][field] = field === 'client' ? val : parseFloat(val) || 0;
            save();
            calculate();
        }

        function save() {
            state.target = parseFloat(document.getElementById('annual-target').value) || 0;
            localStorage.setItem('tribe_v2_data', JSON.stringify(state));
        }

        function saveAndRefresh() {
            save();
            renderAll();
        }

        function calculate() {
            const sym = document.getElementById('currency').value;
            let totalF = 0, totalA = 0;
            let qSums = { 1: {f:0, a:0}, 2: {f:0, a:0}, 3: {f:0, a:0}, 4: {f:0, a:0} };

            state.months.forEach((clients, mIdx) => {
                const q = monthConfig[mIdx].q;
                clients.forEach(c => {
                    totalF += c.forecast; totalA += c.actual;
                    qSums[q].f += c.forecast; qSums[q].a += c.actual;
                });
            });

            document.getElementById('total-f').innerText = sym + totalF.toLocaleString();
            document.getElementById('total-a').innerText = sym + totalA.toLocaleString();
            document.querySelectorAll('.cur-sym').forEach(el => el.innerText = sym);

            const grid = document.getElementById('quarterly-grid');
            grid.innerHTML = '';
            for(let i=1; i<=4; i++) {
                const qTarget = state.target / 4;
                grid.innerHTML += `
                    <div class="bg-white p-4 rounded-2xl border border-gray-200 shadow-sm">
                        <p class="text-[10px] font-black text-gray-800 mb-2 border-b pb-1">QUARTER ${i}</p>
                        <div class="space-y-1">
                            <div class="flex justify-between text-[10px] font-bold text-gray-400"><span>TARGET</span><span class="text-gray-900">${sym}${qTarget.toLocaleString()}</span></div>
                            <div class="flex justify-between text-[10px] font-bold text-gray-400"><span>FORECAST</span><span class="text-gray-900">${sym}${qSums[i].f.toLocaleString()}</span></div>
                            <div class="flex justify-between text-[10px] font-black"><span>ACTUAL</span><span class="text-green-600">${sym}${qSums[i].a.toLocaleString()}</span></div>
                        </div>
                    </div>`;
            }
        }

        init();
    </script>
</body>
</html>
